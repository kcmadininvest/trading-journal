from typing import Dict, Any

SUPPORTED_LANGUAGES = ['fr', 'en', 'es', 'de', 'it', 'pt', 'ja', 'ko', 'zh']
DEFAULT_LANGUAGE = 'fr'

TRANSLATIONS: Dict[str, Dict[str, Any]] = {
    'fr': {
        'lang': 'fr',
        'page_title': 'Rapport de Performance',
        'report_title': 'RAPPORT DE PERFORMANCE',
        'labels': {
            'account': 'Compte de Trading',
            'type': 'Type',
            'period': 'Période',
            'generated': 'Généré le',
        },
        'period': {
            'start': 'Début',
            'end': "Aujourd'hui",
        },
        'cards': {
            'initial_capital': 'Capital Initial',
            'current_capital': 'Capital Actuel',
            'net_pnl': 'P&L Net',
            'total_trades': 'Total Trades',
            'win_rate': 'Win Rate',
            'profit_factor': 'Profit Factor',
        },
        'sections': {
            'metrics': 'Métriques de Performance',
            'general': 'Statistiques Générales',
            'performance': 'Performance',
            'risk': 'Risque',
            'trades_list': 'Liste des Trades',
        },
        'tables': {
            'metric_column': 'Métrique',
            'value_column': 'Valeur',
        },
        'rows': {
            'total_trades': 'Nombre total de trades',
            'winning_trades': 'Trades gagnants',
            'losing_trades': 'Trades perdants',
            'breakeven_trades': 'Trades breakeven',
            'win_rate': 'Win Rate',
            'total_pnl': 'P&L Total',
            'total_fees': 'Frais Totaux',
            'net_pnl': 'P&L Net',
            'return_pct': 'Rendement',
            'avg_win': 'Gain moyen',
            'avg_loss': 'Perte moyenne',
            'largest_win': 'Plus gros gain',
            'largest_loss': 'Plus grosse perte',
            'profit_factor': 'Profit Factor',
            'expectancy': 'Expectancy',
            'risk_reward_ratio': 'Ratio Risque/Rendement',
            'max_drawdown': 'Drawdown Maximum',
            'max_drawdown_pct': 'Drawdown Maximum (%)',
            'current_drawdown': 'Drawdown Actuel',
            'sharpe_ratio': 'Sharpe Ratio',
        },
        'columns': {
            'strategy': 'Stratégie',
            'instrument': 'Instrument',
            'timeframe': 'Timeframe',
            'day': 'Jour',
            'total_trades': 'Total Trades',
            'winning_trades': 'Gagnants',
            'win_rate': 'Win Rate',
            'pnl_total': 'P&L Total',
            'avg_pnl': 'P&L Moyen',
            'date': 'Date',
            'direction': 'Direction',
            'pnl': 'P&L',
            'pnl_pct': 'P&L %',
        },
        'trades': {
            'best_title': 'Meilleurs Trades',
            'worst_title': 'Pires Trades',
        },
        'watermark': 'Généré le {generated} - {account}',
    },
    'en': {
        'lang': 'en',
        'page_title': 'Performance Report',
        'report_title': 'PERFORMANCE REPORT',
        'labels': {
            'account': 'Trading Account',
            'type': 'Type',
            'period': 'Period',
            'generated': 'Generated on',
        },
        'period': {
            'start': 'Start',
            'end': 'Today',
        },
        'cards': {
            'initial_capital': 'Initial Capital',
            'current_capital': 'Current Capital',
            'net_pnl': 'Net P&L',
            'total_trades': 'Total Trades',
            'win_rate': 'Win Rate',
            'profit_factor': 'Profit Factor',
        },
        'sections': {
            'metrics': 'Performance Metrics',
            'general': 'General Statistics',
            'performance': 'Performance',
            'risk': 'Risk',
            'trades_list': 'Trades List',
        },
        'tables': {
            'metric_column': 'Metric',
            'value_column': 'Value',
        },
        'rows': {
            'total_trades': 'Total trades',
            'winning_trades': 'Winning trades',
            'losing_trades': 'Losing trades',
            'breakeven_trades': 'Breakeven trades',
            'win_rate': 'Win Rate',
            'total_pnl': 'Total P/L',
            'total_fees': 'Total fees',
            'net_pnl': 'Net P/L',
            'return_pct': 'Return',
            'avg_win': 'Average win',
            'avg_loss': 'Average loss',
            'largest_win': 'Largest win',
            'largest_loss': 'Largest loss',
            'profit_factor': 'Profit Factor',
            'expectancy': 'Expectancy',
            'risk_reward_ratio': 'Risk/Reward Ratio',
            'max_drawdown': 'Max Drawdown',
            'max_drawdown_pct': 'Max Drawdown (%)',
            'current_drawdown': 'Current Drawdown',
            'sharpe_ratio': 'Sharpe Ratio',
        },
        'columns': {
            'strategy': 'Strategy',
            'instrument': 'Instrument',
            'timeframe': 'Timeframe',
            'day': 'Day',
            'total_trades': 'Total Trades',
            'winning_trades': 'Winning',
            'win_rate': 'Win Rate',
            'pnl_total': 'Total P/L',
            'avg_pnl': 'Average P/L',
            'date': 'Date',
            'direction': 'Direction',
            'pnl': 'P/L',
            'pnl_pct': 'P/L %',
        },
        'trades': {
            'best_title': 'Best Trades',
            'worst_title': 'Worst Trades',
        },
        'watermark': 'Generated on {generated} - {account}',
    },
    'es': {
        'lang': 'es',
        'page_title': 'Informe de Rendimiento',
        'report_title': 'INFORME DE RENDIMIENTO',
        'labels': {
            'account': 'Cuenta de Trading',
            'type': 'Tipo',
            'period': 'Período',
            'generated': 'Generado el',
        },
        'period': {
            'start': 'Inicio',
            'end': 'Hoy',
        },
        'cards': {
            'initial_capital': 'Capital Inicial',
            'current_capital': 'Capital Actual',
            'net_pnl': 'P&L Neto',
            'total_trades': 'Total de operaciones',
            'win_rate': 'Win Rate',
            'profit_factor': 'Profit Factor',
        },
        'sections': {
            'metrics': 'Métricas de Rendimiento',
            'general': 'Estadísticas Generales',
            'performance': 'Rendimiento',
            'risk': 'Riesgo',
            'trades_list': 'Lista de Operaciones',
        },
        'tables': {
            'metric_column': 'Métrica',
            'value_column': 'Valor',
        },
        'rows': {
            'total_trades': 'Total de operaciones',
            'winning_trades': 'Operaciones ganadoras',
            'losing_trades': 'Operaciones perdedoras',
            'breakeven_trades': 'Operaciones breakeven',
            'win_rate': 'Win Rate',
            'total_pnl': 'P/L Total',
            'total_fees': 'Comisiones Totales',
            'net_pnl': 'P/L Neto',
            'return_pct': 'Rendimiento',
            'avg_win': 'Ganancia promedio',
            'avg_loss': 'Pérdida promedio',
            'largest_win': 'Mayor ganancia',
            'largest_loss': 'Mayor pérdida',
            'profit_factor': 'Profit Factor',
            'expectancy': 'Expectativa',
            'risk_reward_ratio': 'Razón Riesgo/Recompensa',
            'max_drawdown': 'Drawdown Máximo',
            'max_drawdown_pct': 'Drawdown Máximo (%)',
            'current_drawdown': 'Drawdown Actual',
            'sharpe_ratio': 'Sharpe Ratio',
        },
        'columns': {
            'strategy': 'Estrategia',
            'instrument': 'Instrumento',
            'timeframe': 'Timeframe',
            'day': 'Día',
            'total_trades': 'Total de operaciones',
            'winning_trades': 'Ganadoras',
            'win_rate': 'Win Rate',
            'pnl_total': 'P/L Total',
            'avg_pnl': 'P/L Promedio',
            'date': 'Fecha',
            'direction': 'Dirección',
            'pnl': 'P/L',
            'pnl_pct': 'P/L %',
        },
        'trades': {
            'best_title': 'Mejores Operaciones',
            'worst_title': 'Peores Operaciones',
        },
        'watermark': 'Generado el {generated} - {account}',
    },
    'de': {
        'lang': 'de',
        'page_title': 'Leistungsbericht',
        'report_title': 'LEISTUNGSBERICHT',
        'labels': {
            'account': 'Handelskonto',
            'type': 'Typ',
            'period': 'Zeitraum',
            'generated': 'Erstellt am',
        },
        'period': {
            'start': 'Start',
            'end': 'Heute',
        },
        'cards': {
            'initial_capital': 'Anfangskapital',
            'current_capital': 'Aktuelles Kapital',
            'net_pnl': 'Netto P&L',
            'total_trades': 'Trades gesamt',
            'win_rate': 'Win Rate',
            'profit_factor': 'Profit Factor',
        },
        'sections': {
            'metrics': 'Kennzahlen',
            'general': 'Allgemeine Statistik',
            'performance': 'Performance',
            'risk': 'Risiko',
            'trades_list': 'Trade-Liste',
        },
        'tables': {
            'metric_column': 'Kennzahl',
            'value_column': 'Wert',
        },
        'rows': {
            'total_trades': 'Trades gesamt',
            'winning_trades': 'Gewinn-Trades',
            'losing_trades': 'Verlust-Trades',
            'breakeven_trades': 'Breakeven-Trades',
            'win_rate': 'Win Rate',
            'total_pnl': 'P/L gesamt',
            'total_fees': 'Gebühren gesamt',
            'net_pnl': 'Netto P/L',
            'return_pct': 'Rendite',
            'avg_win': 'Durchschnittlicher Gewinn',
            'avg_loss': 'Durchschnittlicher Verlust',
            'largest_win': 'Größter Gewinn',
            'largest_loss': 'Größter Verlust',
            'profit_factor': 'Profit Factor',
            'expectancy': 'Erwartung',
            'risk_reward_ratio': 'Risiko-/Chancenverhältnis',
            'max_drawdown': 'Max. Drawdown',
            'max_drawdown_pct': 'Max. Drawdown (%)',
            'current_drawdown': 'Aktueller Drawdown',
            'sharpe_ratio': 'Sharpe Ratio',
        },
        'columns': {
            'strategy': 'Strategie',
            'instrument': 'Instrument',
            'timeframe': 'Timeframe',
            'day': 'Tag',
            'total_trades': 'Trades gesamt',
            'winning_trades': 'Gewinn-Trades',
            'win_rate': 'Win Rate',
            'pnl_total': 'P/L gesamt',
            'avg_pnl': 'Ø P/L',
            'date': 'Datum',
            'direction': 'Richtung',
            'pnl': 'P/L',
            'pnl_pct': 'P/L %',
        },
        'trades': {
            'best_title': 'Top-Trades',
            'worst_title': 'Schlechteste Trades',
        },
        'watermark': 'Erstellt am {generated} - {account}',
    },
    'it': {
        'lang': 'it',
        'page_title': 'Rapporto di Performance',
        'report_title': 'RAPPORTO DI PERFORMANCE',
        'labels': {
            'account': 'Conto di Trading',
            'type': 'Tipo',
            'period': 'Periodo',
            'generated': 'Generato il',
        },
        'period': {
            'start': 'Inizio',
            'end': 'Oggi',
        },
        'cards': {
            'initial_capital': 'Capitale Iniziale',
            'current_capital': 'Capitale Attuale',
            'net_pnl': 'P&L Netto',
            'total_trades': 'Operazioni Totali',
            'win_rate': 'Win Rate',
            'profit_factor': 'Profit Factor',
        },
        'sections': {
            'metrics': 'Metriche di Performance',
            'general': 'Statistiche Generali',
            'performance': 'Performance',
            'risk': 'Rischio',
            'trades_list': 'Elenco Operazioni',
        },
        'tables': {
            'metric_column': 'Metrica',
            'value_column': 'Valore',
        },
        'rows': {
            'total_trades': 'Operazioni totali',
            'winning_trades': 'Operazioni vincenti',
            'losing_trades': 'Operazioni perdenti',
            'breakeven_trades': 'Operazioni breakeven',
            'win_rate': 'Win Rate',
            'total_pnl': 'P/L Totale',
            'total_fees': 'Commissioni Totali',
            'net_pnl': 'P/L Netto',
            'return_pct': 'Rendimento',
            'avg_win': 'Guadagno medio',
            'avg_loss': 'Perdita media',
            'largest_win': 'Maggior guadagno',
            'largest_loss': 'Maggior perdita',
            'profit_factor': 'Profit Factor',
            'expectancy': 'Expectancy',
            'risk_reward_ratio': 'Rapporto Rischio/Rendimento',
            'max_drawdown': 'Max Drawdown',
            'max_drawdown_pct': 'Max Drawdown (%)',
            'current_drawdown': 'Drawdown Attuale',
            'sharpe_ratio': 'Sharpe Ratio',
        },
        'columns': {
            'strategy': 'Strategia',
            'instrument': 'Strumento',
            'timeframe': 'Timeframe',
            'day': 'Giorno',
            'total_trades': 'Operazioni Totali',
            'winning_trades': 'Vincenti',
            'win_rate': 'Win Rate',
            'pnl_total': 'P/L Totale',
            'avg_pnl': 'P/L Medio',
            'date': 'Data',
            'direction': 'Direzione',
            'pnl': 'P/L',
            'pnl_pct': 'P/L %',
        },
        'trades': {
            'best_title': 'Migliori Operazioni',
            'worst_title': 'Peggiori Operazioni',
        },
        'watermark': 'Generato il {generated} - {account}',
    },
    'pt': {
        'lang': 'pt',
        'page_title': 'Relatório de Desempenho',
        'report_title': 'RELATÓRIO DE DESEMPENHO',
        'labels': {
            'account': 'Conta de Trading',
            'type': 'Tipo',
            'period': 'Período',
            'generated': 'Gerado em',
        },
        'period': {
            'start': 'Início',
            'end': 'Hoje',
        },
        'cards': {
            'initial_capital': 'Capital Inicial',
            'current_capital': 'Capital Atual',
            'net_pnl': 'P&L Líquido',
            'total_trades': 'Total de operações',
            'win_rate': 'Win Rate',
            'profit_factor': 'Profit Factor',
        },
        'sections': {
            'metrics': 'Métricas de Desempenho',
            'general': 'Estatísticas Gerais',
            'performance': 'Performance',
            'risk': 'Risco',
            'trades_list': 'Lista de Operações',
        },
        'tables': {
            'metric_column': 'Métrica',
            'value_column': 'Valor',
        },
        'rows': {
            'total_trades': 'Total de operações',
            'winning_trades': 'Operações vencedoras',
            'losing_trades': 'Operações perdedoras',
            'breakeven_trades': 'Operações breakeven',
            'win_rate': 'Win Rate',
            'total_pnl': 'P/L Total',
            'total_fees': 'Taxas Totais',
            'net_pnl': 'P/L Líquido',
            'return_pct': 'Retorno',
            'avg_win': 'Lucro médio',
            'avg_loss': 'Prejuízo médio',
            'largest_win': 'Maior lucro',
            'largest_loss': 'Maior prejuízo',
            'profit_factor': 'Profit Factor',
            'expectancy': 'Expectativa',
            'risk_reward_ratio': 'Rácio Risco/Recompensa',
            'max_drawdown': 'Max Drawdown',
            'max_drawdown_pct': 'Max Drawdown (%)',
            'current_drawdown': 'Drawdown Atual',
            'sharpe_ratio': 'Sharpe Ratio',
        },
        'columns': {
            'strategy': 'Estratégia',
            'instrument': 'Instrumento',
            'timeframe': 'Timeframe',
            'day': 'Dia',
            'total_trades': 'Total de operações',
            'winning_trades': 'Vencedoras',
            'win_rate': 'Win Rate',
            'pnl_total': 'P/L Total',
            'avg_pnl': 'P/L Médio',
            'date': 'Data',
            'direction': 'Direção',
            'pnl': 'P/L',
            'pnl_pct': 'P/L %',
        },
        'trades': {
            'best_title': 'Melhores Operações',
            'worst_title': 'Piores Operações',
        },
        'watermark': 'Gerado em {generated} - {account}',
    },
    'ja': {
        'lang': 'ja',
        'page_title': 'パフォーマンスレポート',
        'report_title': 'パフォーマンスレポート',
        'labels': {
            'account': '取引口座',
            'type': 'タイプ',
            'period': '期間',
            'generated': '生成日',
        },
        'period': {
            'start': '開始',
            'end': '本日',
        },
        'cards': {
            'initial_capital': '初期資金',
            'current_capital': '現在の資金',
            'net_pnl': '純損益',
            'total_trades': '取引合計',
            'win_rate': '勝率',
            'profit_factor': 'Profit Factor',
        },
        'sections': {
            'metrics': 'パフォーマンス指標',
            'general': '基本統計',
            'performance': 'パフォーマンス',
            'risk': 'リスク',
            'trades_list': '取引一覧',
        },
        'tables': {
            'metric_column': '指標',
            'value_column': '値',
        },
        'rows': {
            'total_trades': '取引数',
            'winning_trades': '勝ち取引',
            'losing_trades': '負け取引',
            'breakeven_trades': 'ブレイクイーブン取引',
            'win_rate': '勝率',
            'total_pnl': '合計損益',
            'total_fees': '手数料合計',
            'net_pnl': '純損益',
            'return_pct': 'リターン',
            'avg_win': '平均利益',
            'avg_loss': '平均損失',
            'largest_win': '最大利益',
            'largest_loss': '最大損失',
            'profit_factor': 'Profit Factor',
            'expectancy': '期待値',
            'risk_reward_ratio': 'リスク・リワード比',
            'max_drawdown': '最大ドローダウン',
            'max_drawdown_pct': '最大ドローダウン (%)',
            'current_drawdown': '現在のドローダウン',
            'sharpe_ratio': 'シャープレシオ',
        },
        'columns': {
            'strategy': '戦略',
            'instrument': '銘柄',
            'timeframe': '時間軸',
            'day': '曜日',
            'total_trades': '取引合計',
            'winning_trades': '勝ち取引',
            'win_rate': '勝率',
            'pnl_total': '合計損益',
            'avg_pnl': '平均損益',
            'date': '日付',
            'direction': '方向',
            'pnl': '損益',
            'pnl_pct': '損益 %',
        },
        'trades': {
            'best_title': 'ベストトレード',
            'worst_title': 'ワーストトレード',
        },
        'watermark': '{generated} 作成 - {account}',
    },
    'ko': {
        'lang': 'ko',
        'page_title': '성과 보고서',
        'report_title': '성과 보고서',
        'labels': {
            'account': '거래 계정',
            'type': '유형',
            'period': '기간',
            'generated': '생성일',
        },
        'period': {
            'start': '시작',
            'end': '오늘',
        },
        'cards': {
            'initial_capital': '초기 자본',
            'current_capital': '현재 자본',
            'net_pnl': '순손익',
            'total_trades': '총 거래 수',
            'win_rate': '승률',
            'profit_factor': 'Profit Factor',
        },
        'sections': {
            'metrics': '성과 지표',
            'general': '일반 통계',
            'performance': '성과',
            'risk': '리스크',
            'trades_list': '거래 목록',
        },
        'tables': {
            'metric_column': '지표',
            'value_column': '값',
        },
        'rows': {
            'total_trades': '총 거래 수',
            'winning_trades': '승리 거래',
            'losing_trades': '패배 거래',
            'breakeven_trades': '본전 거래',
            'win_rate': '승률',
            'total_pnl': '총 손익',
            'total_fees': '총 수수료',
            'net_pnl': '순손익',
            'return_pct': '수익률',
            'avg_win': '평균 수익',
            'avg_loss': '평균 손실',
            'largest_win': '최대 수익',
            'largest_loss': '최대 손실',
            'profit_factor': 'Profit Factor',
            'expectancy': '기대값',
            'risk_reward_ratio': '리스크/리워드 비율',
            'max_drawdown': '최대 드로다운',
            'max_drawdown_pct': '최대 드로다운 (%)',
            'current_drawdown': '현재 드로다운',
            'sharpe_ratio': '샤프 비율',
        },
        'columns': {
            'strategy': '전략',
            'instrument': '종목',
            'timeframe': '타임프레임',
            'day': '요일',
            'total_trades': '총 거래 수',
            'winning_trades': '승리',
            'win_rate': '승률',
            'pnl_total': '총 손익',
            'avg_pnl': '평균 손익',
            'date': '날짜',
            'direction': '방향',
            'pnl': '손익',
            'pnl_pct': '손익 %',
        },
        'trades': {
            'best_title': '최고 거래',
            'worst_title': '최악 거래',
        },
        'watermark': '{generated} 생성 - {account}',
    },
    'zh': {
        'lang': 'zh',
        'page_title': '绩效报告',
        'report_title': '绩效报告',
        'labels': {
            'account': '交易账户',
            'type': '类型',
            'period': '周期',
            'generated': '生成时间',
        },
        'period': {
            'start': '开始',
            'end': '今天',
        },
        'cards': {
            'initial_capital': '初始资金',
            'current_capital': '当前资金',
            'net_pnl': '净盈亏',
            'total_trades': '交易总数',
            'win_rate': '胜率',
            'profit_factor': 'Profit Factor',
        },
        'sections': {
            'metrics': '绩效指标',
            'general': '总体统计',
            'performance': '绩效',
            'risk': '风险',
            'trades_list': '交易列表',
        },
        'tables': {
            'metric_column': '指标',
            'value_column': '数值',
        },
        'rows': {
            'total_trades': '交易总数',
            'winning_trades': '盈利交易',
            'losing_trades': '亏损交易',
            'breakeven_trades': '盈亏平衡交易',
            'win_rate': '胜率',
            'total_pnl': '总盈亏',
            'total_fees': '总费用',
            'net_pnl': '净盈亏',
            'return_pct': '回报率',
            'avg_win': '平均盈利',
            'avg_loss': '平均亏损',
            'largest_win': '最大盈利',
            'largest_loss': '最大亏损',
            'profit_factor': 'Profit Factor',
            'expectancy': '期望值',
            'risk_reward_ratio': '风险回报比',
            'max_drawdown': '最大回撤',
            'max_drawdown_pct': '最大回撤 (%)',
            'current_drawdown': '当前回撤',
            'sharpe_ratio': '夏普比率',
        },
        'columns': {
            'strategy': '策略',
            'instrument': '品种',
            'timeframe': '周期',
            'day': '星期',
            'total_trades': '交易总数',
            'winning_trades': '盈利',
            'win_rate': '胜率',
            'pnl_total': '总盈亏',
            'avg_pnl': '平均盈亏',
            'date': '日期',
            'direction': '方向',
            'pnl': '盈亏',
            'pnl_pct': '盈亏 %',
        },
        'trades': {
            'best_title': '最佳交易',
            'worst_title': '最差交易',
        },
        'watermark': '{generated} 生成 - {account}',
    },
}


def get_report_translations(language: str) -> Dict[str, Any]:
    code = (language or '').split('-')[0]
    if code in TRANSLATIONS:
        return TRANSLATIONS[code]
    if code in SUPPORTED_LANGUAGES:
        return TRANSLATIONS[DEFAULT_LANGUAGE]
    return TRANSLATIONS[DEFAULT_LANGUAGE]
